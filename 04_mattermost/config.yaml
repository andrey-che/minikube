apiVersion: v1
data:
  POSTGRES_HOST_AUTH_METHOD: "md5"
  PGDATA: "/var/lib/postgresql/data/pgdata"
  POSTGRES_USER: postgres
kind: ConfigMap
metadata:
  name: postgres-config

---
apiVersion: v1
data:
  # Aa123456
  POSTGRES_PASSWORD: "QWExMjM0NTY="
  MMUSER_PASSWORD: "QWExMjM0NTY="
kind: Secret
metadata:
  name: postgres-secret

---
apiVersion: v1
data:  
  postgres_init.sh: |
    #!/bin/bash
    set -e

    # configmap file is read only, so copy it before editing
    cp /tmp/postgres_init.sql /tmp/postgres_init_mod.sql
    sed -i "s/__MMUSER_PASSWORD__/${MMUSER_PASSWORD}/" /tmp/postgres_init_mod.sql
    sed -i "s/__MM_USER__/${MM_USERNAME}/" /tmp/postgres_init_mod.sql
    sed -i "s/__MM_DATABASE__/${MM_DBNAME}/" /tmp/postgres_init_mod.sql

    psql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" < /tmp/postgres_init_mod.sql
  postgres_init.sql: |
    CREATE USER __MM_USER__ WITH PASSWORD '__MMUSER_PASSWORD__';
    CREATE DATABASE __MM_DATABASE__;
    GRANT ALL PRIVILEGES ON DATABASE __MM_DATABASE__ TO __MM_USER__;
kind: ConfigMap
metadata:
  name: postgres-init-script
  
---
apiVersion: v1
data:
  MM_USERNAME: mmuser
  MM_DBNAME: mattermost
  DB_HOST: postgresql-service
  DB_PORT_NUMBER: "5432"
kind: ConfigMap
metadata:
  name: mattermost-config

---
apiVersion: v1
kind: Secret
metadata:
  name: mattermost-tls
type: kubernetes.io/tls
data:  
  tls.crt: |
        LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZFekNDQXZ1Z0F3SUJBZ0lVYU83YWIraWltT2Z4MEFqNFJoemlXZnRCVWJNd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0dURVhNQlVHQTFVRUF3d09iVzB0ZEdWemRDNDFNalV1YzNVd0hoY05Nakl3TVRNeE1UTTFOekF5V2hjTgpNekl3TVRJNU1UTTFOekF5V2pBWk1SY3dGUVlEVlFRRERBNXRiUzEwWlhOMExqVXlOUzV6ZFRDQ0FpSXdEUVlKCktvWklodmNOQVFFQkJRQURnZ0lQQURDQ0Fnb0NnZ0lCQU5JUG1ERmtET2NiMU5KNXVWcW9nTExxUlhlNzNkdCsKTlpydTJEQVdsQjQ2cWdhL2pKWDNQNTFtdEd0enBtVjRDejAzT2d3MjJ6cithTGdVeGFhb3BhaHVsa2hHM0FZRwpuQVVVQmRGZGdsSUhrK1dzVHNydUc1aGZHRm9kU1BaNldnT0JuVFRYRzI4R3k1OXFvQzk4V3hvT0VoR2hZb1dtCjBIek56ZnhEV085ODBweml6L0dMc1cwQjJRc3RHWUthdXp3WEp0OFZzaG96clRxTVZSZUpWL1JKLzA4cDFEM04KbDRVaHp4SER3clgvbUh2WllBMGU3TkpoZTFreWJtL0ZJR1FabmJRN1EzVlFkUmhubWNNUnJEYUQybkdvTmFzdgp2WTFXVWJOQzJJbndWdWJUZzRJemVOMjRtUUNndkYzYUxVNk1ZL2ZvTHRaUS9DclRwemZsVmtuWHRSNzdLQmFOCnBrRHk5Wm5janYzWnNoWmJiL2V1TlRHU2V2M0xkZXhHaG92VzFrUGtXLzZibDhZS0tXN0VJd2lhenBNTXJoQW8KbnVjZWlGbWdVeCt3bGFvZUxRTVljUDE5M1RxZDF6N294TCtRWkR4dUlCeFAxRDNxOVFaZGV6WlBUM1pNbzFZNApFd3k1KzNQWWdBYVFiNFNJMWEyU2ZodWFOQ1BRTlRkaEd0QlkxRFVCUVJTc0lwd0tZdUY1YVBSVG9rSFlHTXlVCkNCbEFlQlM3dDRaK3RaNHViM1VKMFBwMlptUG9FTW9id09yc3NMNzdodFllMU1MOVJ6U0FLWVNWUUZadThoV2cKSTBDbDczSlJUNTBUUWgwdzJmKzZPOC9BTUx4Sk1HVVhxOUNnWXhqRDNpOW51blp3WmliQUhlVFJRcHZ4YkZENgpZNVRLVGhtMGV0Z1BBZ01CQUFHalV6QlJNQjBHQTFVZERnUVdCQlJCS2xJWW8ybU9Vd0RxRU91VlhwZGVQTXpZCmlqQWZCZ05WSFNNRUdEQVdnQlJCS2xJWW8ybU9Vd0RxRU91VlhwZGVQTXpZaWpBUEJnTlZIUk1CQWY4RUJUQUQKQVFIL01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQlU3cWZHb0hsVkZjTjcvSVlVU0VtWlB6N0tzUDNMQlNTawpiM2lsVDI5ZTQwcVVLdG9YSEZVUTRyMWNuSW45ekZyY2pKZ2dLUlVta0ZlT292dzBVZ05oY0sySUxPWVlhWnhPClIyUHZZblRVUVA1T1ROeHVhTGdUWDM3VFBQS2JwRjA0djM5S2V5STdUSlgrSFFzbWNGYzNuSUx2a1l3QjlMSDUKQjRyN29RRWFvZmVjNUNxekk4L3pGYzhvd0VKTEkrREpGaTZzY0Z5RWxRRXloRm4vRmlyWEVDWVVnSkVLS1hMTgo1bzBIalE3NFZRTHBvQWtCUEw3a3ZuYlRzQTFDZzVSSzhxcktiV0JnbkszWHBwKzBXVFczUnZFRWJrTDhhRTRZCkkzR3AyQ1d2bDNwcmlCaGlHUzNQeGhubkRGeTA2N05HVXRGTUdtWTZXd3ltNEN4VUpNS1FodTlSRkpqdmxkclMKU3pLU0JBMndxWTNVRFUyR1hxQkR2cDBrTkFjYUU0ek9QN3Ayd1NPaFNZaVdpNGxHa1dUQmREanh6M3Jhekd1QQpXQ1RUaiswUjFnMm5vbUszQkNUZWNjenhuS21ZQVRIbCsxSWNJZE10YzNOZUJ3ODkwM2M0SXJVRGM0Rmo1V2JGCklWQWxlRkdzeSt4N3UxMXJ6NXNxTmhIRENnWVZHYnBud0ErQlBvUW5qSmEzZUFLUUJTQXFJa1l0VHBkR20vaHkKVnN0ZXJvVjBvZlRiZUJ1ZmtWMnZoN2dkL2pTVFI3R0p4ejdiRENUQnBLakxxcnNiSmYrbjdYa2lnM1pWcCtwSgpKSEFSVnVsenFQYVVJVmVJRGRrcjJ6NUJpaE9hdlhYTWZhM2xVVmFwR29yejdjeXNYZTBtYlViUmNmcHduZXEzCk9xMzJhZGVNYXc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  tls.key: |
        LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRZ0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1N3d2dna29BZ0VBQW9JQ0FRRFNENWd4WkF6bkc5VFMKZWJsYXFJQ3k2a1YzdTkzYmZqV2E3dGd3RnBRZU9xb0d2NHlWOXorZFpyUnJjNlpsZUFzOU56b01OdHM2L21pNApGTVdtcUtXb2JwWklSdHdHQnB3RkZBWFJYWUpTQjVQbHJFN0s3aHVZWHhoYUhVajJlbG9EZ1owMDF4dHZCc3VmCmFxQXZmRnNhRGhJUm9XS0ZwdEI4emMzOFExanZmTktjNHMveGk3RnRBZGtMTFJtQ21yczhGeWJmRmJJYU02MDYKakZVWGlWZjBTZjlQS2RROXpaZUZJYzhSdzhLMS81aDcyV0FOSHV6U1lYdFpNbTV2eFNCa0daMjBPME4xVUhVWQpaNW5ERWF3Mmc5cHhxRFdyTDcyTlZsR3pRdGlKOEZibTA0T0NNM2pkdUprQW9MeGQyaTFPakdQMzZDN1dVUHdxCjA2YzM1VlpKMTdVZSt5Z1dqYVpBOHZXWjNJNzkyYklXVzIvM3JqVXhrbnI5eTNYc1JvYUwxdFpENUZ2K201ZkcKQ2lsdXhDTUltczZUREs0UUtKN25Ib2hab0ZNZnNKV3FIaTBER0hEOWZkMDZuZGMrNk1TL2tHUThiaUFjVDlROQo2dlVHWFhzMlQwOTJUS05XT0JNTXVmdHoySUFHa0crRWlOV3RrbjRibWpRajBEVTNZUnJRV05RMUFVRVVyQ0tjCkNtTGhlV2owVTZKQjJCak1sQWdaUUhnVXU3ZUdmcldlTG05MUNkRDZkbVpqNkJES0c4RHE3TEMrKzRiV0h0VEMKL1VjMGdDbUVsVUJXYnZJVm9DTkFwZTl5VVUrZEUwSWRNTm4vdWp2UHdEQzhTVEJsRjZ2UW9HTVl3OTR2WjdwMgpjR1ltd0IzazBVS2I4V3hRK21PVXlrNFp0SHJZRHdJREFRQUJBb0lDQUNpU1hvRGJwQ3BYRThuN1BMT243QU9pCmYveGFTc1dFSVBKbHcxZTJaTEZaLzFFQ1dqTDA2RktNYmJoN1E5NUJTMXB0ZWthMXFhNUJTUlNVM29BTC9zTUQKYVA5WXdGSmhvR3pTcXpUKzdKYlBZOTl1WW1HTGo4VGtTUjNPbmpNTStxbkd0UWhwcTZETUhUUVRNaEU1NFphcwp0UXkyc1FMRGIyMUxpc2Q0Y29yKy91YlNYL3QxVWJXT0w4K2F6RnlQYWk1M0Fra0FOY0FkencySjRUMkVoM3BsCmVHeGYxZUNCL3d2MXRicm1wb3JrYlIwdXBRQ2p3blgzNGcwZVVucEFCcnVPdndqNmtWTHRVVkIvWWhGdExtZngKRzVYc09VRnhIUmxaWExwVTVPSHZpN2xWalFidXpoOTA4Z2hQQTFMVk92NzYycXdkS2o2MnNaM0w5M1l5VTNIaAo1UEx6ckpSQU8rcTlodjVldnZDb1dmVVVwWkJ5eVk0ZTVGUEQwUC8vcGp5ZjlZL2xaY0xHZkdTdzR6WnRNR1R1CnVVYTF6TjV2OVo5S0VLeGw1UnRNSWxFQkxxYVBVSTd4QjJEM0ZNc01BVTJJMW4xTUJ0R05KdU1SZG5YU24xWWoKYTFZL1VITlJVT3hYOWVHMnVLY09uT1FMdHhJQVp3R1B2N3ZDU0ZvNEd3Y3h5UC9DZ3RqNEdRQTZoT3ExUzU0cApCcmJKRWJZcWlINnZnSmVQYUM0VVpOSkwvU1ZlSkROVUMzSTFPUzhOTk04djdFSDBkOEltS0pqQ3A0WWdrV0ZLCkZyai9DU0hMeVFOaGR3SW5POXE1cW82aUJIeUV2eDNqZFFFQXZ5RDE0ZHhDTDhyRGsrUGhUYTllTTRyV0lUOGIKV1RoMTNWVTlVcHBZZVExN0RFVGhBb0lCQVFENTl5R1FGWEJNZ2hScmFGcVVvazduQVJyNGtUeFVuN0VEUXN1cgoyYW5WdmV5Q3lpOFBHMmx4OVZ1WG5TTDR0d2FDODh1YkIwZlhPdkF2SmxPNDNVa2UwMTJ1dmlscitBZ3B5aFlWCjYvRzI4LzhtV2pkR2JEblN2cVhkald1Z3l3bGw3SENHYytTWllpdDdZT3RDNEpRU3hSbEtFenhlcXFvY0l2cEoKRkI4TVE5aVBxNGV4MzlOTlgyOTF6NTJoSHBHRitLaHpYZTd0M1ByM2tzYWJ0c2NaczBYNk9RaXg1UWVvOE5nOApPQkQzV04zaVlRZEtKaTBKeEZsbVlQdDVWZU9VUDRlbWVrM2dhMjh6ZWRBcHhlMkdQcU5Pekx6Tk1sMXVKcjFjClNsOEd3aG5sTDFGSjNuRzUzTmJkUXRGQlNHZjZqb0xDYytJUHd3R2dLMHNONWIrM0FvSUJBUURYSWRjNDJGTHAKNDljNy83Z2JTSGsvRmlmZUdySDFidENaTTRmcGppL200NkwyK0l3dGhMSGdVVlV2bTNwc2d6a3BaN2JCM3EyRwpMTVJydzNSbUNNNENkUHBmL1JLL1lVQUxxa0pmYjFMWFhYRU5EQW96WTloZ2hNaDJZUEhoMWsyZWtUakVUNEhECmZwR0s3UVBjS0hPWkRQQlBLTDRsaHZTY3FSajc1d3A5R2ZjVTZsck4rTjRoWEtGSTMxMWRIaHNJeCtZcloyK0EKbEFTRTJ2Z2hpNVA3UWdtT0pER2dWV2kwcGYrQXZaT1pFRHFTRytlN05tRUxkbkl1QW8rL003S1J4TmM5NDFFTgp4SWt5TGJrcU5SRmRsT3gyYjRBajd1WThJMk5uc3IyYUdUS2Y4RlQ2bk5yUmpOL0U2WGltNnIwWmhLZm50RGJoCnUxRjBRQTEzTG5wcEFvSUJBQXhuU3U4UFlVY3FuVURIS05kL1JsTUlKd0oya252UWdNUWNxR2Fhb21iTXlkT2oKbkxvdkxnaE5tSUhwZGpiSlBqVjVTMzBoMjFxK3ZmUlkvb2FKMUhzSEdmcjF6TEJpMm1UWWRrZ1lNU0pXOFM1QwpBOFFtMHFlMmRoeU1TKzdxcEVpK2RzYjFNVDY3TkZVbTlnV1hoMEYzTGs0U3JrZzBSOFNscDYzQXBkbkI5QmtNCjllckpwSDZPWWNXQ3k5dVczTG05SVA2NGhvYWZGSVQ4YjRhQ2gxYXJJcW5MOHJhQkd1UXpMMGV0c0luVml3MFUKcTN2dWNRV3ZESkNiOTE2SitJVCtzZ2g4d1NpRnJEcnRySHFtSzZjaHJKRFliL1h1cmR3dFovQVFjSzZ4S3YvSQpYVXhCRVh1YmpiM2s5dVU2Wm81MFMrRENSMUZvNThlKzNqYU9VL2tDZ2dFQWNBMUJRMnR4TEQrdkFLSTk2NEFCCkh2blVSQndWYXVlUUlPdTFNOUlLWXpGWDFWazU4ZzkyY29jS1hxU1Z6R1ZBNWE4T2dzWVFEWjNOcE8rRjlndEoKK2YraDFWTkVhNGdreXE2Z3FZS2JYRzlnRGRLaWtZZkUwT2o0WEtnNzlFd2gyNkI2TjgzTm9keVB4Qk9WZWh0YgpzbkVKemNGRDRObjlHSWYrNmwyNW1kVm5XMjZCWTF6bm5lcllXdE4wbHFheW9BMDJkbzhHaGFzUyszdnQxOU1TCmZjRTBwdU4xTWJTcXQ4VHFZc3piVHRNa0hxd0lNL3VyNmtPRVR6Q29YSWQ1ei9EOXgwOWFEVmk3dVBZVnhzVWoKU1dIakZBRVpkaDNkcjU4akRJVU51bkM3YkpES1FrcG1zdFMwVEtUcVljNU1OamxoRnc5SHNxVlZWTDUwQlFxaApXUUtDQVFFQStSSEdGaEZiYVJ5cUhNR2ZZYjczU0pYdmVPNXZmejZXM09FSmN4bi84S0k3Y2huaDgrQmJFa2NqClFFQ3c3ZG5TVDNXNzBzS2cxR3d0OHlud2tQM0NjTmFvS0JtTW5LWFlBN25NK0svRlZaQWliSkdaekhjOHJseFkKMkp3T0lhbW9PUE44QWw3WUJMRCsvMmYvWXFTTEo2YzY1QS9WTWdoRDg3SUN6bU9Hdi96OWk4UzI4R0pJMk5LVAo3UzNXYS9xV2VpR3VOdG5vNXIzY05ESGlGTUxlRnN0NmtTaHBGWlRDZ3hUOFJRbnpyT0k1TElLL3dIcitpNWE3CmFZSFFpTmlLdkNPOFZEUXlXaDZhMGxRaU8vRmUwaml1UEFNejc3eGpDb3NjM0ZSa2MxSlV5d0VydG0vTVBPNnAKQjNtZ3kxQTlaNWJMR3U3dWR1L2FRelNZTTNjb2pBPT0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=

